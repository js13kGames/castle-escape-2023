<!doctype html><title>🏃🏰</title><div id=viewport><div id=camera><div id=scene></div></div><div id=inventory><div id=i0 onclick="use(0)"></div><div id=i1 onclick="use(1)"></div><div id=i2 onclick="use(2)"></div><div id=i3 onclick="use(3)"></div><div id=i4 onclick="use(4)"></div><div id=i5 onclick="use(5)"></div><div id=i6 onclick="use(6)"></div><div id=i7 onclick="use(7)"></div><div id=i8 onclick="use(8)"></div><div id=i9 onclick="use(9)"></div><div id=i10 onclick="use(10)"></div><div id=i11 onclick="use(11)"></div></div><div id=text></div><div id=note class=h onclick="innerHTML='',className='h'"></div><div id=bookcover class=h onclick="innerHTML='',className='h';book.className=''">a</div><div id=book class=h onclick="innerHTML='',className='h'"></div></div><script>C={unit:"px",camX:0,camY:0,camZ:0,camRX:0,camRY:0,camRZ:0,sprite_count:0,sprites:[],plane_count:0,cube_count:0,pyramid_count:0,options:{},$:r=>self[r],init:r=>{r.css||(r.css=""),r.on=`txt\`${null!=r.on?r.on:r.css}\``,r.cl&&r.cl.startsWith("room")?r.cl=r.cl?`onclick=if(!animation){fadeout(),setTimeout(()=&gt;{${r.cl}();fadein()},50)}`:"":r.cl=r.cl?`onclick=if(!animation)${r.cl}()`:"",r.html||(r.html=""),r.g||(r.g="scene"),r.o||(r.o="center"),r.w||(r.w=0),r.h||(r.h=0),r.x||(r.x=0),r.y||(r.y=0),r.z||(r.z=0),r.rx||(r.rx=0),r.ry||(r.ry=0),r.rz||(r.rz=0),r.sx||(r.sx=1),r.sy||(r.sy=1),r.sz||(r.sz=1),C.options[r.n]=r},group:r=>{r.d||0===r.d||(r.d=r.h),C.init(r),C.$(r.g).innerHTML+=`<div id="${r.n}"class="group ${r.css}"style="position:absolute;width:${r.w}${C.unit};height:${r.d}${C.unit};transform:${C.tr(r)}">`},plane:r=>{r.n||(r.n="plane"+C.plane_count++),C.init(r),C.$(r.g).insertAdjacentHTML("beforeEnd",`<div id="${r.n}"class="plane ${r.css}"style="position:absolute;width:${r.w}${C.unit};height:${r.h}${C.unit};background:${r.b};transform-origin:${r.o};transform:${C.tr(r)}"onmouseover="${r.on||""}"${r.cl}>${r.html}`),C.camera()},camera:r=>{for(var e in r&&(r.x||0===r.x)&&(C.camX=r.x),r&&(r.y||0===r.y)&&(C.camY=r.y),r&&(r.z||0===r.z)&&(C.camZ=r.z),r&&(r.rx||0===r.rx)&&(C.camRX=r.rx),r&&(r.ry||0===r.ry)&&(C.camRY=r.ry),r&&(r.rz||0===r.rz)&&(C.camRZ=r.rz),C.camX+=(Math.random()-.5)/1e3,scene.style.transform=`translateX(${-C.camX}${C.unit})translateY(${-C.camY}${C.unit})translateZ(${-C.camZ}${C.unit})rotateX(${C.camRX}deg)rotateY(${C.camRY}deg)rotateZ(${C.camRZ}deg)`,C.sprites){var s=C.$(C.sprites[e]),o=s.style.transform.replace(/ *rotate.*\(.*?deg\)/g,"");s.style.transform=o+`rotateZ(${-C.camRZ}deg)rotateX(${-C.camRX}deg)`}},move:r=>{if(r.n){var e=C.$(r.n),s=C.options[r.n];(r.x||0===r.x)&&(s.x=r.x),(r.y||0===r.y)&&(s.y=r.y),(r.z||0===r.z)&&(s.z=r.z),(r.rx||0===r.rx)&&(s.rx=r.rx),(r.ry||0===r.ry)&&(s.ry=r.ry),(r.rz||0===r.rz)&&(s.rz=r.rz),C.options[r.n]=s,e.style.transform=C.tr(s)}},tr:r=>`translateX(-50%)translateY(-50%)translateX(${r.x}${C.unit})translateY(${r.y}${C.unit})translateZ(${r.z}${C.unit})rotateX(${r.rx}deg)rotateY(${r.ry}deg)rotateZ(${r.rz}deg)scaleX(${r.sx})scaleY(${r.sy})scaleZ(${r.sz})`},debug=1,fadeout=()=>{fo.style.opacity=1},fadein=()=>{fo.style.opacity=0},inv=[],using=-1,usingstr="",add_inv=r=>{inv.includes(r)||inv.push(r),draw_inv()},rem_inv=r=>{use(r),inv=inv.filter((e=>e!=r)),draw_inv()},draw_inv=()=>{for(i=0;i<12;i++)self["i"+i].innerHTML="","hanger"==inv[i]?C.plane({g:"i"+i,x:10,y:20,html:svghanger,css:"hanger",on:"",sx:2,sy:2}):"telescope"==inv[i]?C.plane({g:"i"+i,x:20,y:35,html:"🔭",css:"telescope",on:""}):"torch"==inv[i]?C.plane({g:"i"+i,x:40,y:15,w:40,h:30,html:svgtorch,css:"torch",on:""}):"lit torch"==inv[i]?(C.plane({g:"i"+i,x:40,y:15,w:40,h:30,html:svgtorch,css:"lit torch",on:""}),C.plane({g:"i"+i,x:50,y:25,z:2,w:30,h:30,html:"🔥",css:"fire",on:"",sx:.5,sy:.5})):"hammer"==inv[i]?C.plane({g:"i"+i,x:40,y:45,w:40,h:30,html:"🔨",css:"hammer",on:""}):"wood"==inv[i]?C.plane({g:"i"+i,x:40,y:45,w:40,h:30,html:"🪵",css:"wood",on:""}):"boulder"==inv[i]?C.plane({g:"i"+i,x:40,y:45,w:40,h:30,html:"⬤",css:"boulder",on:""}):"mouse"==inv[i]?C.plane({g:"i"+i,x:40,y:45,w:40,h:30,html:"🐁",css:"mouse",on:""}):"soup"==inv[i]?C.plane({g:"i"+i,x:40,y:45,w:40,h:30,html:"🍲",css:"soup",on:""}):"hot soup"==inv[i]?C.plane({g:"i"+i,x:40,y:45,w:40,h:30,html:"🍲",css:"hot soup",on:""}):"crown"==inv[i]?C.plane({g:"i"+i,x:40,y:45,w:40,h:30,html:"👑",css:"crown",on:""}):"gear"==inv[i]?C.plane({g:"i"+i,x:40,y:45,w:40,h:30,html:"⚙️",css:"gear",on:""}):"cheese"==inv[i]?C.plane({g:"i"+i,x:40,y:45,w:40,h:30,html:"🧀",css:"cheese",on:""}):"wand"==inv[i]?C.plane({g:"i"+i,x:40,y:45,w:40,h:30,html:"🪄",css:"wand",on:""}):"sword"==inv[i]&&C.plane({g:"i"+i,x:40,y:45,w:40,h:30,html:"🗡️",css:"sword",on:""})},use=r=>{if(using==r&&r>-1)self["i"+r]&&(self["i"+r].style.background=""),text.innerHTML="",usingstr="",using=-1;else{for(usingstr="",using=-1,i=0;i<12;i++)self["i"+i].style.background="";inv[r]?(self["i"+r].style.background="#fff",text.innerHTML="use "+inv[r]+" with ",using=r,usingstr="use "+inv[r]+" with "):text.innerHTML=""}},lasttxt="",to=0,txt=r=>{r.length&&"c"!=r&&(using>-1&&!["up","right","down","left"].includes(r[0])?text.innerHTML=usingstr+r:text.innerHTML=r,clearTimeout(to),to=setTimeout('if(using == -1) text.innerHTML=""',2e3))},inv=["telescope","torch","hammer","wood","boulder","crown","gear","cheese","mouse","wand","sword","soup"],draw_inv(),windowleft=(r,e)=>{C.plane({x:-280,y:-3,z:-50,w:100,h:100,html:svgwindow,css:"window",ry:e?10:0}),r&&C.plane({x:-320,y:-55,z:-40,html:svgbars,css:"bars",on:""})},windowright=(r,e,s="")=>{C.plane({x:230,y:-3,z:-50,w:100,h:100,html:svgwindow,css:"window",sx:-1,ry:e?-10:0,cl:s}),r&&C.plane({x:278,y:-55,z:-40,html:svgbars,css:"bars",on:"",sx:-1})},draw_sky=(r,e)=>{},wallside=(r,e,s,o,n,l,t)=>{for(o?C.group({n:"wall",x:r?-427:e?370:320,y:(s?110:0)-65,z:r?-88:-40,ry:r?65:120,cl:"r33i",css:"wall"}):C.group({n:"wall",x:r?-427:e?370:320,y:(s?110:0)-65,z:r?-88:-40,ry:r?65:120}),n=0;n<3;n++)for(l=11;l--;)t=l%2?6:0,C.plane({g:"wall",x:12*n+t,y:50*l-200,z:50,w:102,h:52,b:`hsl(50 0% ${50-5*n}%)`,css:"brick"})},tower=(r,e,s,o,n,l,t,a,i)=>{for(scene.className="",scene.innerHTML=text.innerHTML="",setTimeout('scene.className = "t"',200),e=0;e<8;e++)for(s=15;s--;)!(r&&s>1)&&r||(!r||2==s&&e%2)&&r||!(s%2||7!=e)||(a=0,t=104,s%2&&(a=50,0==e&&(t=50,a=25),7==e&&(t=50,a=75)),i=-((o=98*e-300-a+Math.random()+(e>4?2:0))+10)/22,l=-90*Math.cos(o/320),C.plane({x:o,y:48*s-300+Math.random(),w:t,h:50,b:`hsl(50 0% ${30-l/3}%)`,ry:i,z:l,css:"brick"}),s>(r?3:2)&&s<11?(0==e&&(t=35+(s%2?10:0),i=((o=98*e-300-36+4*Math.random()+(s%2?5:0))+10)/22,l=90*Math.cos(o/300)-50,C.plane({x:o,y:51*s-302+Math.random()-8,w:t,h:52,b:"hsl(50 0% 70%)",ry:i,z:l,css:"brick"})),e==(s%2?7:6)&&(t=35+(s%2?10:0),i=((o=98*e-300-65+4*Math.random()+(s%2?-5:100))+10)/22,l=90*Math.cos(o/300)-50,C.plane({x:o,y:51*s-302+Math.random()-8,w:t,h:52,b:"hsl(50 0% 70%)",ry:i,z:l,css:"brick"}))):(a=0,t=102,s%2&&(a=47,0==e&&(t=50,a=22),7==e&&(t=50,a=75)),e>3&&(a-=2),i=((o=98*e-300-a+Math.random())+10)/22,l=90*Math.cos(o/300)-45,C.plane({x:o,y:50*s-300+Math.random()-5,w:t,h:52,b:`hsl(50 0% ${70+l/4}%)`,ry:i,z:l,css:"brick"})))},room=(r,e,s,o,n,l,t,a,i,h,c,m,p,w)=>{for(scene.className="",scene.innerHTML=text.innerHTML="",setTimeout('scene.className = "t"',200),l=0;l<12;l++)for(t=13;t--;)if(s&&o&&l<8&&t<4&&(m=0,c=102,w=0,t%2?(m=47,0==l&&(c=50,m=22),7==l&&(c=50,m=75)):7==l&&(w=1),p=((a=98*l-300-m+Math.random())+10)/22,h=90*Math.cos(a/300)-145,w||C.plane({x:a,y:50*t-300+Math.random()-5,w:c,h:52,b:`hsl(50 0% ${90+h/3}%)`,ry:p,z:h,css:"brick"})),s&&(t>2||2==t&&l%2)||!s){if(m=0,c=104,t%2&&(m=50),a=98*l-500+2*Math.random(),r){if(0==l)continue;1==l&&t%2&&(c=52,m-=25)}if(e){if(11==l||10==l&&!(t%2))continue;10==l&&t%2&&(c=52,m+=25)}if(h=-50,t>(s?2:0)&&C.plane({x:a-m,y:48*t-300+Math.random(),w:c,h:50,b:"hsl(50 0% 43%)",z:h,css:"brick"}),l<2||l>(e?8:9)||t<(s?4:2)||t>11){if(t>(s?3:1)&&t<12&&!(t%2)&&1==l&&!r)continue;if(t>(s?4:2)&&t<12&&t%2&&9==l)continue;if(r33h&&n&&t>1&&t<12&&l>8)continue;!r33h&&n&&t>1&&t<12&&t%2&&10==l?C.plane({x:a-m+25,y:48*t-300+Math.random(),w:50,h:50,b:"hsl(50 0% 63%)",z:-20,css:"brick"}):C.plane({x:a-m,y:48*t-300+Math.random(),w:c,h:50,b:"hsl(50 0% 63%)",z:-20,css:"brick"})}}},mount=()=>{C.plane({x:0,y:250,z:-80,w:1800,h:400,b:"radial-gradient(#582,#9c6)",css:"mount",on:""})},room00=()=>{tower(1),C.plane({x:-5,y:-130,z:-20,w:690,h:70,b:"linear-gradient(#333,#555)",rx:105,css:"c"}),C.plane({x:-5,y:225,z:-30,w:690,h:70,b:"linear-gradient(#333,#555)",rx:60,css:"c"}),C.plane({x:-65,y:115,html:svgdoor,w:60,h:100,css:"door",sx:1.6,sy:1.6,ry:5}),C.plane({x:-80,y:80,z:5,html:"⬇️",css:"arrow",on:"down",cl:"room01",ry:5}),r00d||C.plane({x:145,y:-30,w:20,h:15,html:svghanger,css:"hanger",n:"r002",cl:"r00c"}),r00f?(C.plane({x:-105,y:120,z:20,html:"🔒",css:"lock",rz:-2,cl:"r00e",n:"r003",x:-120,y:200,rz:-80}),C.plane({x:-132,y:110,html:"🚪",css:"door",ry:5,z:10,n:"r004",o:"100px 100px",x:-100,y:115,z:15,ry:120})):(C.plane({x:-105,y:120,z:20,html:"🔒",css:"lock",rz:-2,cl:"r00e",n:"r003"}),C.plane({x:-132,y:110,html:"🚪",css:"door",ry:5,z:10,n:"r004",o:"100px 100px"})),r00b>=1?C.group({x:105,y:-10,z:10,n:"frame",y:140,rx:-80}):C.group({x:105,y:-10,z:10,n:"frame"}),C.plane({x:0,y:-25,html:"🖼️",css:"frame",rz:2,cl:"r00a",n:"r001",g:"frame"}),C.plane({x:40,y:-15,html:"️🧔🏻‍♂️",css:"framehead nofont",on:"",rz:2,g:"frame"}),C.plane({x:45,y:-26,html:"👑️",css:"framecrown",on:"",rz:2,sy:.5,g:"frame"}),C.plane({x:245,y:120,html:"🛏️",css:"bed",sx:-1}),C.plane({x:-265,y:193,z:-50,html:"🕳️",css:"hole",rz:90,ry:10,sy:2}),windowleft(1,1)},r00b=3,r00a=()=>{frame.style.animation="wiggle .5s",setTimeout('frame.style.animation="";',600),r00b++,r00b>=1&&(r001.onclick="",C.move({n:"frame",y:140,rx:-80}))},r00d=1,r00c=()=>{add_inv("hanger"),r002.remove(),r00d=1},r00f=1,r00e=()=>{"hanger"==inv[using]&&(C.move({n:"r003",x:-120,y:200,rz:-80}),C.move({n:"r004",x:-100,y:115,z:15,ry:120}),rem_inv("hanger"),r00f=1)},room01=()=>{tower(0),C.plane({x:-5,y:-190,z:-20,w:690,h:70,b:"linear-gradient(#333,#555)",rx:105,css:"c"}),C.plane({x:-5,y:225,z:-30,w:690,h:70,b:"linear-gradient(#333,#555)",rx:60,css:"c"}),C.plane({x:10,y:-50,html:"🛡️",css:"shield",rz:2}),C.plane({x:-160,y:198,w:100,h:200,html:svgdoorstair,ry:9,sx:1.6,sy:1.6}),r01a?(C.plane({x:0,y:170,html:"🪵",css:"wood",z:-5}),C.plane({x:-50,y:220,z:0,w:90,h:50,html:svgcannon,css:r01b?"loaded cannon":"cannon",sx:2.7,sy:2.7,o:"bottom left",cl:"r01d",n:"r011",rz:-25})):C.plane({x:-50,y:220,z:0,w:90,h:50,html:svgcannon,css:r01b?"loaded cannon":"cannon",sx:2.7,sy:2.7,o:"bottom left",cl:"r01d",n:"r011"}),C.plane({x:-165,y:65,z:40,html:"⬇️",css:"arrow",on:"down",cl:"room02"}),C.plane({x:-207,y:65,z:40,html:"⬆️",css:"arrow",on:"up",cl:"room00"}),C.plane({x:-50,y:r01a?125:180,z:-5,html:"⬤",css:"boulder",n:"r012",cl:"r01e"}),windowright(0,1)},r01a=1,r01b=1,r01c=0,r01d=()=>{"use wood with "==usingstr?(r01a=1,C.plane({x:0,y:170,html:"🪵",css:"wood",z:-5}),C.move({n:"r011",rz:-25}),rem_inv("wood"),C.move({n:"r012",y:125}),use(-1)):"use boulder with "==usingstr&&(r01b=1,rem_inv("boulder"),r011.className="loaded cannon",r011.setAttribute("onmouseover","txt`loaded cannon`"),use(-1)),"use lit torch with "==usingstr&&r01a&&r01b&&(r01b=0,r011.className="cannon",r011.setAttribute("onmouseover","txt`cannon`"),C.move({n:"r012",x:600,y:-170,z:-135}),use(-1),animation=1,setTimeout(anim1,500)),"use lit torch with "==usingstr&&!r01a&&r01b&&(r01b=0,r011.className="cannon",r011.setAttribute("onmouseover","txt`cannon`"),C.move({n:"r012",x:235}),setTimeout('C.move({n:"r012",x:215})',510),use(-1))},r01e=()=>{add_inv("boulder"),r012.remove()},room02=()=>{room(1,0,1,1),C.plane({x:25,y:-120,z:-50,w:950,h:50,b:"linear-gradient(#333,#555)",rx:145}),C.plane({x:25,y:235,z:-50,w:950,h:70,b:"linear-gradient(#333,#555)",rx:60}),wallside(1,0,1),r02a||C.plane({x:190,y:170,w:30,h:30,html:"🔭",css:"telescope",rz:2,sx:-1,n:"r021",cl:"r02b"}),C.plane({x:-50,y:150,w:50,h:100,z:-20,html:svgdoorstair,sx:1.6,sy:1.6}),C.plane({x:-45,y:95,z:40,html:"⬆️",css:"arrow",on:"up",cl:"room01"}),C.plane({x:275,y:95,z:40,html:"➡️",css:"arrow",on:"right",cl:"room12"}),windowleft(0)},r02a=1,r02b=()=>{add_inv("telescope"),r021.remove(),r02a=1},room03=()=>{note.className="h",room(1,0,0,0),mount(),C.plane({x:25,y:-220,z:-50,w:950,h:50,b:"linear-gradient(#333,#555)",rx:145}),C.plane({x:25,y:235,z:-50,w:950,h:70,b:"linear-gradient(#333,#555)",rx:60}),C.plane({x:-90,y:125,w:30,h:30,html:"💺",css:"throne",sx:-1}),C.plane({x:250,y:185,w:30,h:30,html:"🪨",css:"rock",sx:-1}),inv.includes("sword")||C.plane({x:210,y:135,z:-5,w:30,h:30,html:"🗡️",css:"sword",sx:-1,rz:40,rx:-30,cl:"room03p"}),C.plane({x:275,y:95,z:40,html:"➡️",css:"arrow",on:"right",cl:"room13"}),wallside(1,0)},room03p=()=>{r03pm="",room(1,0,0,0),C.plane({x:25,y:0,z:50,w:950,h:650,b:"linear-gradient(#333,#555)"}),C.plane({x:-170,y:30,z:70,html:"🪨",css:"rock",sx:-1,sx:2,sy:2}),C.plane({x:50,y:55,z:50,w:30,h:30,html:"🗡️",css:"sword2",on:"pull sword",sx:-1,rz:54,rx:-50,n:"r03p1",cl:"r03pp"}),C.plane({x:-360,y:-180,z:80,html:"❌",css:"cross",on:"exit",cl:"room03"}),C.plane({x:-30,y:-180,z:80,html:"⬆️",css:"arrow",on:"up",cl:"r03pu"}),C.plane({x:180,y:0,z:80,html:"➡️",css:"arrow",on:"right",cl:"r03pr"}),C.plane({x:-230,y:0,z:80,html:"⬅️",css:"arrow",on:"left",cl:"r03pl"}),C.plane({x:-30,y:140,z:80,html:"⬇️",css:"arrow",on:"down",cl:"r03pd"})},r03pm="",r03pp=()=>{r03pm.endsWith("uuddlrlr")?(C.move({n:"r03p1",x:80,y:-50,z:200}),setTimeout(room03,510),add_inv("sword")):(r03p1.style.animation="wiggle .2s 2",setTimeout('r03p1.style.animation=""',510))},r03pu=()=>{C.move({n:"r03p1",rx:-30}),setTimeout('C.move({n:"r03p1",rx:-50})',510),r03pm+="u"},r03pl=()=>{C.move({n:"r03p1",rz:30}),setTimeout('C.move({n:"r03p1",rz:55})',510),r03pm+="l"},r03pr=()=>{C.move({n:"r03p1",rz:70}),setTimeout('C.move({n:"r03p1",rz:55})',510),r03pm+="r"},r03pd=()=>{C.move({n:"r03p1",rx:-70}),setTimeout('C.move({n:"r03p1",rx:-50})',510),r03pm+="d"},room12=(r,e)=>{for(room(0,0,1,0),C.plane({x:-15,y:-120,z:-50,w:950,h:50,b:"linear-gradient(#333,#555)",rx:145}),C.plane({x:-15,y:235,z:-50,w:950,h:70,b:"linear-gradient(#333,#555)",rx:60}),C.plane({x:-150,y:95,html:"🪜",css:"shelf"}),r=0;r<3;r++)for(e=0;e<4;e++)e>0&&!((r+e-3)%3)||1==r&&0==e||C.plane({x:32*r-35+10*Math.random(),y:65*e-30,w:20+2*Math.random(),h:45,b:`hsl(${20*(5*r+15*e)} 50% 63%)`,z:20,css:"book",cl:"book"+r+e});C.plane({x:235,y:145,w:50,h:100,html:svgdoor,sx:-1.6,sy:1.6}),C.plane({x:275,y:95,z:40,html:"➡️",css:"arrow",on:"right",cl:"room22"}),C.plane({x:-325,y:95,z:40,html:"⬅️",css:"arrow",on:"left",cl:"room02"}),C.plane({x:195,y:165,z:40,html:"⬇️",css:"arrow",on:"down",cl:"room13"})},room13=()=>{r13b=0,room(0,0,0,0),C.plane({x:-25,y:-220,z:-50,w:950,h:50,b:"linear-gradient(#333,#555)",rx:145}),C.plane({x:-25,y:235,z:-50,w:950,h:70,b:"linear-gradient(#333,#555)",rx:60}),C.plane({x:-220,y:105,w:50,h:100,html:svgknight,css:"knight",sx:2.8,sy:2.8,cl:"r13a"}),C.plane({x:215,y:140,w:50,h:100,html:svgdoorstair,sx:-1.6,sy:1.6}),C.plane({x:275,y:95,z:40,html:"➡️",css:"arrow",on:"right",cl:"room23"}),C.plane({x:-325,y:95,z:40,html:"⬅️",css:"arrow",on:"left",cl:"r13a"}),C.plane({x:175,y:85,z:40,html:"⬆️",css:"arrow",on:"up",cl:"room12"})},r13b=0,r13c=0,r13a=()=>{r13c?(room03(),use(-1)):"use crown with "!=usingstr||r13c?(note.innerHTML=1==r13b?"(I'm new here,<br>I haven't seen him in person yet)":"Only the king can enter the throne room!",note.className="",r13b++):(note.innerHTML="Welcome, sir",note.className="",setTimeout(room03,1e3),r13c=1,use(-1))},room20=(r=1)=>{tower(1),C.plane({x:-5,y:-130,z:-20,w:690,h:70,b:"linear-gradient(#333,#555)",rx:105,css:"c"}),C.plane({x:-5,y:225,z:-30,w:690,h:70,b:"linear-gradient(#333,#555)",rx:60,css:"c"}),C.plane({x:90,y:80,html:"⬤",css:"boulder",n:"r201",cl:"r20a"}),C.plane({x:120,y:130,html:"⬤",css:"boulder",n:"r202",cl:"r20b"}),C.plane({x:60,y:130,html:"⬤",css:"boulder",n:"r203",cl:"r20c"}),C.plane({x:150,y:180,html:"⬤",css:"boulder",n:"r204",cl:"r20d"}),C.plane({x:90,y:180,html:"⬤",css:"boulder",n:"r205",cl:"r20e"}),C.plane({x:30,y:180,html:"⬤",css:"boulder",n:"r206",cl:"r20f"}),r&&C.plane({x:-300,y:20,html:"⬤",css:"boulder",n:"r2099",cl:"r20z"}),C.plane({x:-50,y:-20,html:"🛡️",css:"shield",rz:2}),C.plane({x:210,y:20,html:"🔒",css:"lock",rz:-2,z:10}),C.plane({x:210,y:-15,html:"🔗",css:"chain",rz:40}),C.plane({x:-85,y:120,w:50,h:100,z:-20,html:svgdoor,ry:5,sx:-1.6,sy:1.6}),r||C.plane({x:-95,y:65,z:40,html:"⬇️",css:"arrow",on:"down",cl:"room21"}),windowleft(0),windowright(1)},r20g=0,r20h=0,r20i=0,r20j=0,r20k=0,r20l=0,r20a=()=>{add_inv("boulder"),r201.remove(),r20g=1},r20b=()=>{r20g&&!inv.includes("boulder")&&(add_inv("boulder"),r202.remove(),r20h=1)},r20c=()=>{r20g&&!inv.includes("boulder")&&(add_inv("boulder"),r203.remove(),r20i=1)},r20d=()=>{r20h&&r20i&&!inv.includes("boulder")&&(add_inv("boulder"),r204.remove(),r20j=1)},r20e=()=>{r20h&&r20i&&!inv.includes("boulder")&&(add_inv("boulder"),r205.remove(),r20k=1)},r20f=()=>{r20h&&r20i&&!inv.includes("boulder")&&(add_inv("boulder"),r206.remove(),r20l=1)},room21=()=>{tower(0),C.plane({x:-5,y:-190,z:-20,w:690,h:70,b:"linear-gradient(#333,#555)",rx:105,css:"c"}),C.plane({x:-5,y:225,z:-30,w:690,h:70,b:"linear-gradient(#333,#555)",rx:60,css:"c"}),C.plane({x:-40,y:120,z:-20,w:100,h:100,html:svghay,on:"hay",sx:2.8,sy:2.8,cl:"r21a"}),C.plane({x:-235,y:130,w:50,h:100,z:-20,html:svgdoorstair,ry:5,sx:1.5,sy:1.6}),C.plane({x:-220,y:70,z:40,html:"⬆️",css:"arrow",on:"up",cl:"room20"}),C.plane({x:-180,y:70,z:40,html:"⬇️",css:"arrow",on:"down",cl:"room22"}),windowright(0,1,"r21a")},r21b=0,r21a=()=>{"use telescope with "==usingstr&&C.plane({x:180,y:140,w:30,h:30,html:"🔭",css:"telescope",rz:2,sx:-1,sy:1.1})},room22=(r,e)=>{room(0,0,1,1),C.plane({x:-15,y:-120,z:-50,w:950,h:50,b:"linear-gradient(#333,#555)",rx:145}),C.plane({x:-15,y:235,z:-50,w:950,h:70,b:"linear-gradient(#333,#555)",rx:60}),C.plane({x:85,y:75,html:"📜",css:"note",sx:1.6,sy:1.6,cl:"r22a"}),C.plane({x:-25,y:85,w:50,h:10,z:10,html:svgtorchsupport,css:"torch holder",sx:1.6,sy:1.6,cl:"r22f"}),r22b||C.plane({x:-40,y:45,w:50,h:50,html:svgtorch,on:"torch",sx:1.6,sy:1.6,cl:"r22c",n:"r221"}),!r22b&&r22e&&C.plane({x:-35,y:50,z:20,w:30,h:30,html:"🔥",css:"fire",on:"torch",n:"r222",cl:"r22c"}),C.plane({x:-205,y:140,w:50,h:100,html:svgdoorstair,sx:1.6,sy:1.6}),C.plane({x:275,y:95,z:40,html:"➡️",css:"arrow",on:"right",cl:"room32"}),C.plane({x:-325,y:95,z:40,html:"⬅️",css:"arrow",on:"left",cl:"room12"}),C.plane({x:-190,y:85,z:40,html:"⬆️",css:"arrow",on:"up",cl:"r22d"})},r22a=()=>{note.className="",note.innerHTML="This tower contains flammable material, please leave torch here before going up"},r22b=1,r22e=0,r22f=()=>{inv.includes("lit torch")?(rem_inv("lit torch"),r22b=0,r22e=1,C.plane({x:-40,y:45,w:50,h:50,html:svgtorch,on:"torch",sx:1.6,sy:1.6,cl:"r22c",n:"r221"}),C.plane({x:-35,y:50,z:20,w:30,h:30,html:"🔥",css:"fire",on:"torch",n:"r222",cl:"r22c"})):inv.includes("torch")?(rem_inv("torch"),r22b=0,r22e=0,C.plane({x:-40,y:45,w:50,h:50,html:svgtorch,on:"torch",sx:1.6,sy:1.6,cl:"r22c",n:"r221"})):r22c(),use(-1)},r22c=()=>{r22e?(add_inv("lit torch"),r222.remove()):add_inv("torch"),r221.remove(),r22b=1},r22d=()=>{r22b?r22a():room21()},room23=()=>{room(0,0,0,0),mount(),C.plane({x:-45,y:-220,z:-50,w:950,h:50,b:"linear-gradient(#333,#555)",rx:145}),C.plane({x:-45,y:235,z:-50,w:950,h:70,b:"linear-gradient(#333,#555)",rx:60}),C.plane({x:-150,y:35,w:60,h:100,html:svgexit,css:"doors",sx:4,sy:4}),C.plane({x:10,y:35,w:60,h:100,html:svgexit,css:"doors",sx:-4,sy:4}),C.plane({x:275,y:95,z:40,html:"➡️",css:"arrow",on:"right",cl:"room33"}),C.plane({x:-325,y:95,z:40,html:"⬅️",css:"arrow",on:"left",cl:"room13"})},room32=()=>{room(0,0,1,0),C.plane({x:-15,y:-120,z:-50,w:950,h:50,b:"linear-gradient(#333,#555)",rx:145}),C.plane({x:-15,y:235,z:-50,w:950,h:70,b:"linear-gradient(#333,#555)",rx:60}),C.plane({x:-120,y:230,w:30,h:30,html:"🔨",css:"hammer",on:"",rz:-45}),r32a||C.plane({x:-120,y:180,z:40,w:20,h:20,on:"???",n:"r321",cl:"r32b"}),C.plane({x:-310,y:230,html:"🪵",css:"wood",rz:-90}),C.plane({x:-270,y:230,z:10,html:"🪵",css:"wood",rz:-90}),r32c||C.plane({x:-290,y:200,html:"🪵",css:"wood",rz:-90,n:"r322",cl:"r32d"}),C.plane({x:70,y:125,html:"🏦",css:"fireplace",cl:"r32e"}),C.plane({x:123,y:185,z:20,w:30,h:30,html:"🔥",css:"fire",cl:"r32e"}),C.plane({x:178,y:185,z:20,w:30,h:30,html:"🔥",css:"fire",cl:"r32e",sx:-1}),C.plane({x:193,y:185,z:20,w:30,h:30,html:"🔥",css:"fire",cl:"r32e"}),C.plane({x:168,y:163,z:10,w:115,h:70,b:"#444",on:"fireplace",cl:"r32e"}),C.plane({x:180,y:25,z:-40,w:80,h:300,b:"#555",on:"fireplace",cl:"r32e"}),C.plane({x:-100,y:185,w:100,h:50,html:svganvil,css:"anvil",sx:2,sy:2}),C.plane({x:275,y:95,z:40,html:"➡️",css:"arrow",on:"right",cl:"room42"}),C.plane({x:-325,y:95,z:40,html:"⬅️",css:"arrow",on:"left",cl:"room22"})},r32a=1,r32b=()=>{add_inv("hammer"),r321.remove(),r32a=1},r32c=1,r32d=()=>{add_inv("wood"),r322.remove(),r32b=1},r32e=()=>{"use torch with "==usingstr?(inv[using]="lit torch",usingstr="use lit torch with ",draw_inv()):"use soup with "==usingstr&&(animation=1,rem_inv("soup"),use(-1),C.plane({x:130,y:150,z:30,html:"🍲",css:"soup",n:"r323",cl:"r32g"}),C.plane({x:130,y:150,z:31,html:"🍲",css:"hot soup o0",n:"r324",cl:"r32g"}),setTimeout('r324.className="plane hot soup";r324.setAttribute("onmouseover","txt`hot soup`");animation=0',2e3))},r32f=0,r32g=()=>{add_inv("hot soup"),r323.remove(),r324.remove(),r32f=1},room33=()=>{room(0,0,0,0,1),C.plane({x:25,y:-220,z:-50,w:1050,h:50,b:"linear-gradient(#333,#555)",rx:145}),C.plane({x:25,y:235,z:-50,w:1050,h:70,b:"linear-gradient(#333,#555)",rx:60}),r33h||C.plane({x:400,y:0,z:40,w:120,h:400,on:"wall",cl:"r33i",n:"r334"}),C.plane({x:-60,y:-55,html:svgtable,css:"",sx:3,sy:3}),C.plane({x:10,y:45,html:"🧑🏻‍🍳",css:"cook",cl:"r33g"}),r33e||C.plane({x:-40,y:75,html:"🧀",css:"cheese",cl:"r33f",n:"r332"}),r33c||(r33b?C.plane({x:130,y:60,html:"🍲",css:"hot soup",cl:"r33c",n:"r331"}):C.plane({x:130,y:60,html:"🍲",css:"soup",cl:"r33d",n:"r331"})),C.plane({x:-250,y:-60,html:"🛡️",css:"shield",rz:2}),r33h&&C.plane({x:325,y:95,z:40,html:"➡️",css:"arrow",on:"right",cl:"room43"}),r33h&&C.plane({x:495,y:15,z:40,html:svgrock,css:"",sx:-2,sy:2}),r33h&&C.plane({x:295,y:15,z:40,html:svgrock,css:"",sx:2,sy:2}),r33h&&C.plane({x:435,y:25,z:40,html:svgrock,css:"",sx:-2,sy:2}),C.plane({x:-325,y:95,z:40,html:"⬅️",css:"arrow",on:"left",cl:"room23"}),r33h||wallside(0,1,0,1)},r33b=1,r33a=()=>{note.innerHTML=r33b&&!r33c?"Thanks! You can take the cheese":"Please help me heating up the soup!",note.className=""},r33c=0,r33d=()=>{r33b||(r33a(),add_inv("soup"),r331.remove(),r33c=1)},r33e=0,r33f=()=>{r33b&&!r33c?(add_inv("cheese"),r332.remove(),r33e=1):(note.innerHTML="Please help me heating up the soup first!",note.className="")},r33g=()=>{"use hot soup with "==usingstr?(C.plane({x:130,y:60,html:"🍲",css:"hot soup",cl:"r33c",n:"r331"}),rem_inv("hot soup"),r33c=0,r33a(),use(-1),draw_inv()):r33a()},r33h=0,r33i=()=>{"use hammer with "==usingstr&&(r33h=1,use(-1),rem_inv("hammer"),draw_inv(),fadeout(),setTimeout(room33,200),setTimeout(fadein,800))},room40=()=>{tower(1),C.plane({x:-5,y:-130,z:-20,w:690,h:70,b:"linear-gradient(#333,#555)",rx:105,css:"c"}),C.plane({x:-5,y:225,z:-30,w:690,h:70,b:"linear-gradient(#333,#555)",rx:60,css:"c"}),C.plane({x:80,y:100,w:60,h:100,html:svgwitch,css:"witch",sx:2.5,sy:2.5,cl:"r40a"}),r40b&&C.plane({x:190,y:160,w:60,h:100,html:"🪄",css:"wand"}),C.plane({x:80,y:-100,html:"🦇",css:"bat",sy:-1}),C.plane({x:150,y:-95,html:"🦇",css:"bat",sy:-1}),C.plane({x:-30,y:120,w:50,h:100,z:-20,html:svgdoor,ry:0,sx:1.6,sy:1.6}),C.plane({x:-15,y:70,z:40,html:"⬇️",css:"arrow",on:"down",cl:"room41"}),r40b&&(C.plane({x:-110,y:50,z:80,html:"↩️",css:"arrow",on:"future",cl:"r40r"}),C.plane({x:-180,y:50,z:80,html:"↪️",css:"arrow",on:"past",cl:"r40l"})),C.group({n:"wheel",x:-175,y:15,w:150,h:150,on:"time wheel",css:"timewheel",o:"center center"}),C.plane({g:"wheel",x:75,y:75,w:150,h:150,b:"#def",css:"c wheel",on:"time wheel"}),C.plane({g:"wheel",html:"🌞",on:"",x:60,y:10}),C.plane({g:"wheel",html:"🌘",on:"",x:60,y:105}),C.plane({w:158,h:200,x:-175,y:110,b:"linear-gradient(#854,#631)",css:"base",on:"time wheel"})},r40b=1,r40a=()=>{"use wand with "==usingstr?(r40b=1,rem_inv("wand"),use(-1),C.plane({x:190,y:160,w:60,h:100,html:"🪄",css:"wand"}),note.innerHTML="You can now turn the wheel of time! You can choose the sun and moon's position in the sky...",note.className="",C.plane({x:-110,y:50,z:80,html:"↩️",css:"arrow",on:"future",cl:"r40r"}),C.plane({x:-180,y:50,z:80,html:"↪️",css:"arrow",on:"past",cl:"r40l"})):r40b||(note.innerHTML="I am the time witch... I need my wand to power my time machine.<br>I heard they put it in a chest somewhere...",note.className="")},r40c=0,r40d=0,update_sky=()=>{console.log(r40c),-60==r40c&&(r40c=300),r40c>360&&(r40c-=360),console.log(r40c),(r40c<=60||r40c>240)&&(viewport.style.background="#cde"),r40c>60&&r40c<=240&&(viewport.style.background="#002")},r40r=()=>{r40c+=60,r40d+=60,C.move({n:"wheel",rz:r40d}),update_sky()},r40l=()=>{r40c-=60,r40d-=60,C.move({n:"wheel",rz:r40d}),update_sky()},room41=()=>{tower(0),C.plane({x:-5,y:-190,z:-20,w:690,h:70,b:"linear-gradient(#333,#555)",rx:105,css:"c"}),C.plane({x:-5,y:225,z:-30,w:690,h:70,b:"linear-gradient(#333,#555)",rx:60,css:"c"}),C.plane({x:80,y:130,html:"🧍‍♂️",css:"prisoner"}),C.plane({x:190,y:120,html:"🔗",css:"chain",rz:20}),C.plane({x:220,y:100,html:"🔗",css:"chain",rz:5}),C.plane({x:240,y:80,html:"🔗",css:"chain",rz:-35}),C.plane({x:-110,y:125,w:50,h:100,z:-20,html:svgdoorstair,ry:5,sx:1.6,sy:1.6}),C.plane({x:50,y:140,html:"🔗",css:"chain"}),C.plane({x:70,y:120,html:"🔗",css:"chain"}),C.plane({x:90,y:100,html:"🔗",css:"chain"}),C.plane({x:30,y:180,z:10,html:"💀",css:"skeleton",rz:-30}),C.plane({x:50,y:200,html:"🦴",css:"skeleton",rz:-30}),C.plane({x:40,y:220,html:"🦴",css:"skeleton",rz:-60}),C.plane({x:30,y:210,html:"🦴",css:"skeleton",rz:-90}),C.plane({x:-115,y:70,z:40,html:"⬆️",css:"arrow",on:"up",cl:"room40"}),C.plane({x:-78,y:70,z:40,html:"⬇️",css:"arrow",on:"down",cl:"room42"}),windowleft(0)},room42=()=>{room(0,1,1,1),C.plane({x:-45,y:-120,z:-50,w:950,h:50,b:"linear-gradient(#333,#555)",rx:145}),C.plane({x:-45,y:235,z:-50,w:950,h:70,b:"linear-gradient(#333,#555)",rx:60}),wallside(0,0,1),C.plane({x:-205,y:145,w:50,h:100,html:svgdoorstair,sx:1.6,sy:1.6}),C.plane({x:-262,y:145,z:10,html:"🚪",css:"door"}),C.plane({x:-230,y:140,z:15,html:"🔒",css:"lock",rz:-2}),C.plane({x:-75,y:65,html:"📜",css:"note",sx:1.6,sy:1.6,cl:"r42a"}),C.plane({x:250,y:255,z:-50,html:"🕳️",css:"hole",rz:90,sx:-1,sy:2}),C.plane({x:-325,y:95,z:40,html:"⬅️",css:"arrow",on:"left",cl:"room32"}),C.plane({x:-195,y:95,z:5,html:"⬆️",css:"arrow",on:"up",cl:"room41"}),C.plane({x:50,y:60,html:"🛡️",css:"shield",rz:2}),windowright(0)},r42a=()=>{note.className="",note.innerHTML="This tower contains dangerous prisoners"},room43=()=>{room(0,1,0,0),mount(),C.plane({x:-45,y:-220,z:-50,w:950,h:50,b:"linear-gradient(#333,#555)",rx:145}),C.plane({x:-45,y:235,z:-50,w:950,h:70,b:"linear-gradient(#333,#555)",rx:60}),r43c?C.plane({x:70,y:145,w:100,h:100,html:svgchestopen,css:"chest",sx:2,sy:2,cl:"room43p"}):C.plane({x:70,y:145,w:100,h:100,html:svgchest,css:"chest",sx:2,sy:2,cl:"room43p"}),r43c||C.plane({x:50,y:140,html:"🔒",css:"lock",rz:-2,cl:"room43p"}),r43c&&!r43d&&C.plane({x:50,y:110,html:"🪄",css:"wand",rz:30,cl:"r43e",n:"r432"}),r43a||C.plane({x:-250,y:185,html:"👑",css:"crown",cl:"r43b",n:"r431"}),C.plane({x:-325,y:95,z:40,html:"⬅️",css:"arrow",on:"left",cl:"room33"}),wallside(0),windowright(1)},r43a=0,r43b=()=>{add_inv("crown"),r431.remove(),r43a=1},r43d=0,r43e=()=>{add_inv("wand"),r432.remove(),r43d=1},r43c=1,room43p=()=>{r43pm="",r43pa=0,room(1,0,0,0),C.plane({x:25,y:0,z:50,w:950,h:650,b:"linear-gradient(#853,#642 50%,#000 50%,#000 50.5%,#642 50.5%,#431)"}),C.plane({x:-360,y:-180,z:80,html:"❌",css:"cross",on:"exit",cl:"room43"}),C.plane({x:150,y:50,z:80,html:"↩️",css:"arrow",on:"right",cl:"r43pr"}),C.plane({x:-200,y:50,z:80,html:"↪️",css:"arrow",on:"left",cl:"r43pl"}),C.plane({x:-130,y:20,z:50,html:"🔒",css:"big lock",on:"lock",rz:-2}),C.plane({x:-10,y:100,z:50,w:50,h:50,o:"30px 0px",html:"🐉",css:"dragon",on:"",n:"r43p1",sx:2,sy:2,rz:-2})},r43pm="",r43pa=0,r43pl=()=>{r43pa-=90,r43pm+="l",C.move({n:"r43p1",rz:r43pa}),r43pm.endsWith("lrrrrlr")&&(fadeout(),r43c=1,setTimeout("room43();fadein()",500))},r43pr=()=>{r43pa+=90,r43pm+="r",C.move({n:"r43p1",rz:r43pa}),r43pm.endsWith("lrrrrlr")&&(fadeout(),r43c=1,setTimeout("room43();fadein()",500))},svgwindow="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><path d='M5 95A35 75 0 0 1 75 95Z' fill='#def' stroke='#555' stroke-width='4'/><path d='M75 95A35 77 0 0 0 33 21A40 89 0 0 1 65 94Z' fill='#777' stroke='#555' stroke-width='4'/></svg>️",svgbars="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><path d='M25 30L24 95M44 28L45 95' fill='#fff' stroke='#111' stroke-width='8'/></svg>",svgcannon="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><path d='M90 15L90 36L25 40A15 15 0 0 1 25 10Z' fill='#222' stroke='#000'/><circle cx=26 cy=32 r=10 fill='#955' stroke='#000'/><path d='M15 13L10 5' stroke='#950'stroke-width='4'/></svg>",svgdoorstair="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><rect x=5 y=5 width=55 height=90 fill='#222' stroke='#000'/><path d='M5 45L10 45L10 55L5 55L20 55L20 65L5 65L30 65L30 75L5 75L40 75L40 85L5 85L50 85L50 95L5 95Z' fill='#444' stroke='#000'/></svg>",svgdoor="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><rect x=5 y=5 width=55 height=90 fill='#222' stroke='#000'/><path d='M60 5L5 55L5 5Z' fill='#000' stroke='#000'/></svg>",svghay="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><path d='M40 59L34 63L36 58L31 59L36 54M64 63L70 66L62 67M55 45L59 49L52 49L50 53L48 47M30 72L23 74L27 69M24 54Q49 13 73 54L69 54L76 58L72 58L80 64L75 64L88 78L83 77L90 83L77 80L79 84L63 80L66 83L50 79L49 83L46 79L36 84L39 79L21 85L24 80L9 85L14 80L7 81L17 73L8 75L21 68L14 68L26 57Z' fill='#ff9' stroke='#555'/></svg>",svgwitch="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><path d='M26 33L68 28L53 25L36 0L35 27Z' fill='#a49' stroke='#222'/><path d='M52 42L72 53L55 63L50 52L55 63L61 59L69 95L18 94L33 50L29 62L20 55L36 43Z' fill='#a49' stroke='#222'/><path d='M36 32L29 41L37 39L36 46L30 51L43 50L52 42L53 30M24 58L20 64L25 67L28 62M62 59L65 67L73 63L66 57Z' fill='#fec' stroke='#222'/></svg>",svganvil="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><path d='M95 0L5 0Q16 15 31 16Q46 25 17 40L17 45L80 45L80 40Q35 21 95 4Z' fill='#111' stroke='#000'/></svg>",svgchest="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><rect x=10 y=50 width=80 height=40 fill='#853' stroke='#333'/><rect x=10 y=64 width=80 height=13 fill='#853' stroke='#333'/><path d='M10 50Q13 33 25 30L75 30Q90 33 90 50Z' fill='#853' stroke='#333'/></svg>",svgchestopen="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><rect x=10 y=50 width=80 height=40 fill='#853' stroke='#333'/><rect x=10 y=64 width=80 height=13 fill='#853' stroke='#333'/><path d='M10 50L10 17Q10 8 19 8L79 8Q90 8 90 17L90 50Z' fill='#742' stroke='#333'/></svg>",svgtable="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><rect x=5 y=50 width=90 height=7 fill='#853' stroke='#222'/><rect x=10 y=57 width=5 height=38 fill='#853' stroke='#222'/><rect x=85 y=57 width=5 height=38 fill='#853' stroke='#222'/><rect x=15 y=57 width=70 height=38 fill='#888' stroke='#222'/></svg>",svgexit="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><path d='M5 95L50 95L50 30Q4 27 5 95' fill='#853' stroke='#333'/><circle cx=38 cy=63 r=4 fill='#fe8' stroke='#333'/></svg>",svgknight="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><path d='M24 28L11 34Q16 11 25 28L21 42L12 40L11 33M22 40L28 48L26 72L9 73L12 40M10 72L9 97L21 97L13 93L17 72M25 72L24 91L31 96L20 95L19 72M22 31L20 39M19 33L18 39M16 34L16 39' fill='#999' stroke='#444'/><path d='M10 40L15 44L11 55L14 66L7 68L5 54L10 40' fill='#999' stroke='#444'/></svg>",svgtorchsupport="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><rect x=0 y=0 width=31 height=6 fill='#854' stroke='#222'/></svg>",svgtorch="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><path d='M25 24L14 64L19 66L37 29Z' fill='#854' stroke='#222'/></svg>",svghanger="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><path d='M34 4L18 6Q14 19 6 9' stroke='#000' fill='#0000' stroke-width='4'/></svg>",svgplan="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><path d='M20 87L26 82L29 88L26 82L23 98M13 38L17 42M16 38L13 42M53 10L49 14M49 10L53 14M83 60L87 64M87 60L83 64M65 82L70 86M69 81L65 86M5 95L95 95L95 5L75 5L75 50L60 50L60 5L40 5L40 50L25 50L25 5L5 5Z' fill='#fff' stroke='#000'/></svg>",svgrock="<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><path d='M4 94L19 94L17 85L9 81L4 88L4 94M17 85L24 73L36 74L35 89L18 91L17 85M35 93L39 85L48 92Z' fill='#ccc' stroke='#222'/></svg>",animation=0,anim1=()=>{animation=1,room20(1),r2099.style.transformOrigin="250px 150px",r2099.style.transition="1s all",setTimeout('C.move({n:"r2099",x:-200,rz:100,z:30})',100)},book00=(r,e)=>{bookcover.innerHTML="The big book of inventions",bookcover.style.background="hsl(0 50% 63%)",book.innerHTML="Things invented so far<br>Castles<br>Cannons<br>Clocks<br>Telescopes<br>...<br><br>Coming soon<br>Electricity<br>Microwaves<br>Nuclear fission<br>JavaScript (eww)<br>...",bookcover.className=""},book20=()=>{i=2,j=0,bookcover.innerHTML="How Arthur Became King",bookcover.style.background=`hsl(${20*(5*i+15*j)} 50% 63%)`,book.innerHTML="Knight Arthur,<br>On the stone saw the sword,<br>Nudged twice up, twice down,<br>And twice on both sides,<br>Making him the king,<br>In the land of Britain<br><br><br><br><br><br>",bookcover.className=""},book11=()=>{i=1,j=1,bookcover.innerHTML="Horse Jokes",bookcover.style.background=`hsl(${20*(5*i+15*j)} 50% 63%)`,book.innerHTML='Sir 1: why did you call your<br>horse "Mayo" ?<br>Sir 2: You\'ll see...<br>Mayo: *neighs*<br><br>~~~<br><br>On which side does a horse<br>have the most hair?<br>The outside<br><br>~~~<br><br>How to get a horse to sleep?<br>Tell him "it\'s pasture bedtime"',bookcover.className=""},book01=()=>{i=0,j=1,bookcover.innerHTML="Decoding shields",bookcover.style.background=`hsl(${20*(5*i+15*j)} 50% 63%)`,book.innerHTML="I've been told that<br>symbols must be read<br>from top to bottom<br>while colors are read<br>from left to right.",bookcover.className=""},book02=()=>{i=0,j=2,bookcover.innerHTML="Map of the castle",bookcover.style.background=`hsl(${20*(5*i+15*j)} 50% 63%)`,book.innerHTML+="<br><br><br><br><br><br><br>Thou are here",C.plane({g:"book",html:"<svg width=99 height=99 xmlns='http://www.w3.org/2000/svg'><path d='M20 87L26 82L29 88L26 82L23 98M13 38L17 42M16 38L13 42M53 10L49 14M49 10L53 14M83 60L87 64M87 60L83 64M65 82L70 86M69 81L65 86M5 95L95 95L95 5L75 5L75 50L60 50L60 5L40 5L40 50L25 50L25 5L5 5Z' fill='#fff' stroke='#000'/></svg>",x:40,y:-200,sx:1.5,sy:1.5,css:"plan"}),bookcover.className=""},book13=()=>{i=1,j=3,bookcover.innerHTML="The gears of power",bookcover.style.background=`hsl(${20*(5*i+15*j)} 50% 63%)`,book.innerHTML="I guess they look like this:",b13b||C.plane({g:"book",html:"⚙️",x:10,y:100,css:"gear",cl:"b13a"}),bookcover.className=""},b13b=0,b13a=()=>{add_inv("gear"),b13b=1},book22=()=>{i=2,j=2,bookcover.innerHTML="Phases of the moon",bookcover.style.background=`hsl(${20*(5*i+15*j)} 50% 63%)`,book.innerHTML="A moon cycle is 30 days long.<br>🌑 🌓 🌔 🌕 🌖 🌘 🌑<br>new -------- full -------- new",bookcover.className=""},book23=()=>{i=2,j=3,bookcover.innerHTML="Drag on",bookcover.style.background=`hsl(${20*(5*i+15*j)} 50% 63%)`,C.plane({g:"book",w:50,h:50,html:"🐉️",x:50,y:60,css:"dragon",o:"20px 20px"}),C.plane({g:"book",w:50,h:50,html:"🐉️",x:70,y:100,rz:-90,css:"dragon",o:"20px 20px"}),C.plane({g:"book",w:50,h:50,html:"🐉️",x:50,y:170,rz:0,css:"dragon",o:"20px 20px"}),C.plane({g:"book",w:50,h:50,html:"🐉️",x:30,y:210,rz:90,css:"dragon",o:"20px 20px"}),C.plane({g:"book",w:50,h:50,html:"🐉️",x:50,y:250,rz:180,css:"dragon",o:"20px 20px"}),C.plane({g:"book",w:50,h:50,html:"🐉️",x:70,y:350,rz:270,css:"dragon",o:"20px 20px"}),C.plane({g:"book",w:50,h:50,html:"🐉️",x:50,y:390,rz:180,css:"dragon",o:"20px 20px"}),C.plane({g:"book",w:50,h:50,html:"🐉️",x:70,y:430,rz:270,css:"dragon",o:"20px 20px"}),bookcover.className=""};</script><style>#text,#viewport .brick,svg{pointer-events:none}#book,#bookcover,#note{box-shadow:0 0 5px #000;color:#000}#fo,#text{position:absolute;left:0;width:960px}@font-face{font-family:e;src:url(Twemoji.ttf)}@keyframes wiggle{50%{margin-left:-5px}100%{margin-left:0}}#viewport{width:1200px;height:540px;overflow:hidden;position:relative;perspective:500px;cursor:pointer;cursor:grab;background:#cde;transition:background 1s}#viewport *{transform-style:preserve-3d;box-sizing:border-box;line-height:0}#bookcover,#note,#text{text-align:center;font:45px Papyrus,Calibri}.t *{transition:.5s}*{user-select:none}.o0{opacity:0}#inventory{width:250px;background:#555;height:100%;position:absolute;right:0}#inventory div{background:#ccc;width:115px;height:80px;margin:5px;float:left}#viewport .plane{font-size:170px;font-family:e}svg{position:absolute;top:0}#text{bottom:10px;color:#fff;text-shadow:0 0 15px #000,0 0 5px #000,0 0 5px #000}#note{position:absolute;top:50px;left:100px;width:800px;background:#fea;padding:50px}#camera{width:0;height:0;position:absolute;top:50%;left:480px}#viewport .c{border-radius:50%;border-width:8px;transition:none}#viewport .brick{border:3px solid #555;transition:none}#viewport .door{font-size:150px;filter:sepia(.5) drop-shadow(0 0 4px #000)}#viewport .lock{font-size:40px;filter:sepia(.5) saturate(.5) drop-shadow(0 0 2px #000)}#viewport .lock.big{font-size:250px}#viewport .chain{font-size:40px;filter:sepia(.5) drop-shadow(0 0 2px #000)}#viewport .bed{filter:sepia(.8) drop-shadow(0 0 4px #000)}#viewport .hole{font-size:40px}#viewport .frame{font-size:90px;filter:sepia(.9) drop-shadow(0 0 4px #000)}#viewport .framecrown,#viewport .framehead{font-size:30px;pointer-events:none}#viewport .nofont{font-family:""}#viewport .framehead{filter:sepia(.5)}#viewport .framecrown,#viewport .shield{filter:sepia(.5) drop-shadow(0 0 4px #000)}#viewport .shield{font-size:100px}#viewport .boulder{font-size:80px}#viewport .pin{font-size:30px}#viewport .triangle{color:#111;font-size:30px}#viewport .prisoner{font-size:170px;filter:sepia(.9) drop-shadow(0 0 4px #000)}#viewport .witch{filter:sepia(.5) drop-shadow(0 0 4px #000)}#viewport .telescope{font-size:150px;filter:sepia(.9) drop-shadow(0 0 4px #000)}#viewport .shelf{font-size:300px;filter:sepia(.6)}#viewport .book{border:2px solid #222;filter:sepia(.5) drop-shadow(0 0 1px #000)}#viewport .hammer{font-size:70px;filter:sepia(.8) brightness(.2) drop-shadow(0 0 1px #000)}#viewport .wood{font-size:70px;filter:sepia(.5) drop-shadow(0 0 1px #000)}#viewport .fireplace{font-size:200px;filter:sepia(.2) brightness(.5) drop-shadow(0 0 1px #000)}#viewport .fire{font-size:50px;filter:sepia(.2);animation:.2s infinite wiggle;transform-origin:center center}#viewport .skeleton{font-size:50px;filter:saturate(0)}#viewport .note{font-size:50px;filter:sepia(.5) brightness(.7) drop-shadow(0 0 1px #000)}#viewport .cheese,#viewport .cook,#viewport .soup{filter:sepia(.2) drop-shadow(0 0 1px #000)}#viewport .cook{font-size:100px}#viewport .cheese{font-size:50px}#viewport .soup{font-size:80px;transition:opacity 1.5s}#viewport .mouse{filter:sepia(.2) drop-shadow(0 0 2px #000)}#viewport .soup.hot{font-size:80px;filter:sepia(.2) hue-rotate(293deg) drop-shadow(0 0 1px #000)}#viewport .throne{font-size:260px;filter:sepia(.5) saturate(.5) hue-rotate(348deg) drop-shadow(0 0 1px #000)}#viewport .rock{font-size:160px;filter:sepia(.5) saturate(.5) drop-shadow(0 0 1px #000)}#viewport .bat{font-size:60px;filter:saturate(.5) brightness(.5) drop-shadow(0 0 1px #000)}#viewport .sword{font-size:130px;filter:sepia(.5) saturate(.5) hue-rotate(348deg) drop-shadow(0 0 1px #000)}#viewport .crown,#viewport .wand{filter:sepia(.5) drop-shadow(0 0 1px #000)}#viewport .wand{font-size:60px}#viewport .crown{font-size:90px}#viewport .arrow,#viewport .sword2{filter:saturate(.4) drop-shadow(0 0 5px #000)}#viewport .arrow{font-size:35px}#viewport .sword2{font-size:200px}#viewport .cross{font-size:40px;filter:saturate(.8) drop-shadow(0 0 5px #000)}#viewport .dragon{font-size:50px}#sun,.sunwrapper{pointer-events:none}.h{display:none}#inventory div .plane{background:0 0;font-size:60px!important;font-family:e}#inventory div .telescope{filter:sepia(.9) brightness(.6)}#bookcover{width:350px;height:490px;background:#cba;margin:25px 0 0 250px;padding:20px}#book{width:750px;height:490px;background:linear-gradient(90deg,#fed 48%,#876 50%,#fed 52%);margin:28px 0 0 125px;border:10px solid #555;font:25px/30px Papyrus,Calibri;padding:10px}.mount{border-radius:50%}#fo{top:0;height:540px;pointer-events:none;background:#000;transition:opacity .5s}.wheel{background:radial-gradient(#854 20%,#222 22%,#0000 24%),linear-gradient(#cde 45%,#002 55%)!important;border:2px solid #854;outline:#000 solid 2px}.base{border:2px solid #222}#viewport .timewheel *{font:30px e}